/**
 * {{properCase name }}
 */

import React from 'react';
import { 
{{#if wantUseQuery}}
  useQuery,
{{/if}}
{{#if wantUseLazyQuery}}
  useLazyQuery,
{{/if}}
{{#if wantUseMutation}}
  useMutation,
{{/if}}
{{#if wantUseSubscription}}
  useSubscription,
{{/if}}
} from '@apollo/react-hooks'
{{#if wantRouteHooks}}
import { useHistory, useLocation, useParams, useRouteMatch } from 'react-router-dom'
{{/if}}
{{#if wantFormHooks}}
import { useForm } from 'react-hook-form'
import { validationSchema } from './validations'
import { FieldNames } from './enums'
import { {{properCase name }}Props } from './interfaces'
import ErrorMessage from 'components/ErrorMessage';
{{/if}}
import { 
  GET_{{constantCase name}},
  CREATE_{{constantCase name}},
} from './gql'
{{#if wantStyledComponents}}
import styled from 'styled-components'
import { Container } from './styled'
{{/if}}



{{#if wantUseQuery}}
// @dev call query when component render
export const Get{{ properCase name }} = () => {
  const { loading, error, data } = useQuery(GET_{{constantCase name}}, {
    variables: {
      name: 'John Doe'
    }
  })

  if (loading) return <div>...loading</div>
  if (error) return <div>{JSON.stringify(error)}</div>
  return (
    <div>{JSON.stringify(data)}</div>
  )
}
{{/if}}

{{#if wantUseLazyQuery}}
// @dev return function that you can call to execute query
export const LazyGet{{ properCase name }} = () => {
  const [getTodos, { loading, error, data }] = useLazyQuery(GET_{{constantCase name}})

  React.useEffect(() => {
    getTodos({
      variables: {
        name: 'John Doe'
      }
    })
  }, [])

  if (loading) return <div>...loading</div>
  if (error) return <div>{JSON.stringify(error)}</div>
  return (
    <div>{JSON.stringify(data)}</div>
  )
}
{{/if}}

{{#if wantUseMutation}}
export const Create{{ properCase name }} = () => {
  const [createTodo,  { loading, error, data }] = useMutation(CREATE_{{constantCase name}})

  if (loading) return <div>...Loading</div>
  if (error) return <div>{JSON.stringify(error)}</div>
  return (
    <div>
      <button 
        type="button"
        onClick={() => createTodo({ 
          variables: { task: 'Buy Something', checked: true }  
        })}
      >Add Todo</button>
      <div>{JSON.stringify(data)}</div>
    </div>
  )
}
{{/if}}


{{#if wantFormHooks}}
const Form = () => {
  const { register, handleSubmit, errors: formErrors } = useForm({
    validationSchema,
    defaultValues: {
      [FieldNames.FIRST_NAME]: "bill",
      [FieldNames.LAST_NAME]: "luo",
      [FieldNames.PASSWORD]: '123123123',
      [FieldNames.CONFIRM_PASSWORD]: '123123123',
      [FieldNames.EMAIL]: "bluebill1049@hotmail.com",
      [FieldNames.WEBSITE]: 'www.google.com',
    }
  });

  const onSubmit = handleSubmit(async (values) => {
    try {
      // Do something
    } catch (error) {
      // Do something
    }
  });

  return (
    <form onSubmit={onSubmit}>
      <input
        name={FieldNames.FIRST_NAME}
        placeholder="First Name"
        ref={register}
      />
      <ErrorMessage errors={formErrors} name={FieldNames.FIRST_NAME} />
      <input
        name={FieldNames.LAST_NAME}
        placeholder="Last Name"
        ref={register}
      />
      <ErrorMessage errors={formErrors} name={FieldNames.LAST_NAME} />
      <input
        name={FieldNames.PASSWORD}
        placeholder="Password"
        ref={register}
      />
      <ErrorMessage errors={formErrors} name={FieldNames.PASSWORD} />
      <input
        name={FieldNames.CONFIRM_PASSWORD}
        placeholder="Confirm Password"
        ref={register}
      />
      <ErrorMessage errors={formErrors} name={FieldNames.CONFIRM_PASSWORD} />
      <input
        name={FieldNames.EMAIL}
        placeholder="Email"
        ref={register}
      />
      <ErrorMessage errors={formErrors} name={FieldNames.EMAIL} />
      <input
        name={FieldNames.WEBSITE}
        placeholder="Website"
        ref={register}
      />
      <ErrorMessage errors={formErrors} name={FieldNames.WEBSITE} />
      <button type="submit">Submit</button>
    </form>
  )
  
}
{{/if}}

const {{ properCase name }}: React.FC<{{properCase name }}Props> = () => {
  return (
    <div>
        {{#if wantFormHooks}}
        <Form />
        {{/if}}
        {{#if wantUseQuery}}
        <Get{{ properCase name }} />
        {{/if}}
        {{#if wantUseLazyQuery}}
        <LazyGet{{ properCase name }} />
        {{/if}}
        {{#if wantUseMutation}}
        <Create{{ properCase name }} />
        {{/if}}

    </div>
  );
}

export default {{ properCase name }}